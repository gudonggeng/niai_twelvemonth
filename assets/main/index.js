System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,s,o,a,u,l,c,h,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,s=t.createClass},function(t){o=t.cclegacy,a=t._decorator,u=t.AudioSource,l=t.AudioClip,c=t.CCString,h=t.sys,g=t.Component}],execute:function(){var m,d,_,b,p,f,v,y,S,x,E;o._RF.push({},"0c7ee7D8FBIi4PLU38wEQ6v","AudioManager",void 0);var I=a.ccclass,T=a.property;t("AudioManager",(m=I("AudioManager"),d=T(u),_=T([l]),b=T({type:[c]}),m(((E=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s))||this,n(e,"bgmSource",v,r(e)),n(e,"bgmTracks",y,r(e)),n(e,"bgmNames",S,r(e)),n(e,"defaultBgmVolume",x,r(e)),e.KEY_VOL="tm_audio_bgm_volume_v1",e.KEY_IDX="tm_audio_bgm_index_v1",e._idx=0,e._vol=1,e._started=!1,e._onEnded=function(){e.bgmTracks&&0!==e.bgmTracks.length&&(e._idx=(e._idx+1)%e.bgmTracks.length,e._saveInt(e.KEY_IDX,e._idx),e.bgmSource&&(e._applyClipByIndex(e._idx),e.scheduleOnce((function(){var t;null==(t=e.bgmSource)||t.play()}),0)))},e}i(e,t);var o=e.prototype;return o.onLoad=function(){e._inst&&e._inst!==this?this.node.destroy():(e._inst=this,this._vol=this._loadFloat(this.KEY_VOL,this.defaultBgmVolume),this._idx=this._loadInt(this.KEY_IDX,0),this.bgmTracks.length>0?(this._idx=this._idx%this.bgmTracks.length,this._idx<0&&(this._idx=0)):this._idx=0,this.bgmSource&&(this.bgmSource.volume=this._vol))},o.onDestroy=function(){this.bgmSource&&this.bgmSource.node.off(u.EventType.ENDED,this._onEnded,this),e._inst===this&&(e._inst=null)},o.startBgm=function(){if(this.bgmSource)if(this.bgmTracks&&0!==this.bgmTracks.length){if(this.bgmSource.playing)return this._started=!0,void this._ensureEndedHandler();this._started=!0,this._ensureEndedHandler(),this._applyClipByIndex(this._idx),this.bgmSource.play()}else console.warn("[AudioManager] bgmTracks 为空");else console.warn("[AudioManager] bgmSource 未绑定")},o.nextBgm=function(){this.bgmTracks&&0!==this.bgmTracks.length&&(this._idx=(this._idx+1)%this.bgmTracks.length,this._saveInt(this.KEY_IDX,this._idx),this.bgmSource&&(this._applyClipByIndex(this._idx),this._started&&(this.bgmSource.stop(),this.bgmSource.play())))},o.setBgmVolume=function(t){t=this._clamp01(t),this._vol=t,this._saveFloat(this.KEY_VOL,t),this.bgmSource&&(this.bgmSource.volume=t)},o.getBgmVolume=function(){return this._vol},o.getBgmIndex=function(){return this._idx},o.getCurrentBgmName=function(){var t,e,i;if(this.bgmNames&&this.bgmNames.length===this.bgmTracks.length)return null!=(i=this.bgmNames[this._idx])?i:"";var n=null==(t=this.bgmTracks)?void 0:t[this._idx];return null!=(e=null==n?void 0:n.name)?e:""},o._applyClipByIndex=function(t){var e,i;if(this.bgmSource){var n=null!=(e=null==(i=this.bgmTracks)?void 0:i[t])?e:null;n&&(this.bgmSource.clip=n,this.bgmSource.loop=!1,this.bgmSource.volume=this._vol)}},o._ensureEndedHandler=function(){this.bgmSource&&(this.bgmSource.node.off(u.EventType.ENDED,this._onEnded,this),this.bgmSource.node.on(u.EventType.ENDED,this._onEnded,this))},o._clamp01=function(t){return Number.isFinite(t)?t<0?0:t>1?1:t:0},o._loadFloat=function(t,e){try{var i=h.localStorage.getItem(t);if(!i)return e;var n=parseFloat(i);return Number.isFinite(n)?n:e}catch(t){return e}},o._loadInt=function(t,e){try{var i=h.localStorage.getItem(t);if(!i)return e;var n=parseInt(i,10);return Number.isFinite(n)?n:e}catch(t){return e}},o._saveFloat=function(t,e){try{h.localStorage.setItem(t,String(e))}catch(t){}},o._saveInt=function(t,e){try{h.localStorage.setItem(t,String(e))}catch(t){}},s(e,null,[{key:"I",get:function(){return this._inst}}]),e}(g))._inst=null,v=e((f=E).prototype,"bgmSource",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=e(f.prototype,"bgmTracks",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S=e(f.prototype,"bgmNames",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=e(f.prototype,"defaultBgmVolume",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.68}}),p=f))||p));o._RF.pop()}}}));

System.register("chunks:///_virtual/AudioSettingsPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./GameManagers.ts"],(function(e){var n,t,i,r,a,o,s,l,u,g,h,m,d,c,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Button,l=e.Node,u=e.Slider,g=e.Label,h=e.Vec3,m=e.tween,d=e.Component},function(e){c=e.AudioManager},function(e){f=e.GameManagers}],execute:function(){var p,b,S,x,B,y,v,P,N,w,M,C,L,T,_,z,I,E,O,A;a._RF.push({},"13fd5PQWPZDv5zL3cfrEcK4","AudioSettingsPanel",void 0);var D=o.ccclass,F=o.property;e("AudioSettingsPanel",(p=D("AudioSettingsPanel"),b=F(s),S=F(l),x=F(u),B=F(u),y=F(s),v=F(g),P=F(f),N=F(c),p((C=n((M=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,i(n,"iconBtn",C,r(n)),i(n,"expandPanel",L,r(n)),i(n,"bgmSlider",T,r(n)),i(n,"sfxSlider",_,r(n)),i(n,"nextBgmBtn",z,r(n)),i(n,"bgmNameLabel",I,r(n)),i(n,"gm",E,r(n)),i(n,"audioManager",O,r(n)),i(n,"animTime",A,r(n)),n._open=!1,n}t(n,e);var a=n.prototype;return a.onLoad=function(){this._applyOpen(!1,!0),this.iconBtn?(this.iconBtn.node.off(s.EventType.CLICK,this.toggle,this),this.iconBtn.node.on(s.EventType.CLICK,this.toggle,this)):(this.node.off(l.EventType.TOUCH_END,this.toggle,this),this.node.on(l.EventType.TOUCH_END,this.toggle,this)),this.bgmSlider&&(this.bgmSlider.node.off("slide",this.onBgmSlide,this),this.bgmSlider.node.on("slide",this.onBgmSlide,this)),this.sfxSlider&&(this.sfxSlider.node.off("slide",this.onSfxSlide,this),this.sfxSlider.node.on("slide",this.onSfxSlide,this)),this.nextBgmBtn&&(this.nextBgmBtn.node.off(s.EventType.CLICK,this.onNextBgm,this),this.nextBgmBtn.node.on(s.EventType.CLICK,this.onNextBgm,this))},a.start=function(){this.syncFromManagers()},a.toggle=function(){this.setOpen(!this._open)},a.setOpen=function(e){e!==this._open&&(this._open=e,this._applyOpen(e,!1))},a.onBgmSlide=function(){var e,n=null!=(e=this.audioManager)?e:c.I;n&&this.bgmSlider&&(n.setBgmVolume(this.bgmSlider.progress),this.refreshBgmName())},a.onSfxSlide=function(){this.gm&&this.sfxSlider&&this.gm.setSfxVolume(this.sfxSlider.progress)},a.onNextBgm=function(){var e,n,t=null!=(e=this.audioManager)?e:c.I;t&&(null==(n=t.bgmSource)||n.stop(),t.nextBgm(),this.refreshBgmName())},a.syncFromManagers=function(){var e,n=null!=(e=this.audioManager)?e:c.I;this.bgmSlider&&n&&(this.bgmSlider.progress=n.getBgmVolume()),this.sfxSlider&&this.gm&&(this.sfxSlider.progress=this.gm.getSfxVolume()),this.refreshBgmName()},a.refreshBgmName=function(){var e;if(this.bgmNameLabel){var n=null!=(e=this.audioManager)?e:c.I;this.bgmNameLabel.string=n&&n.getCurrentBgmName()?"♪ "+n.getCurrentBgmName():""}},a._applyOpen=function(e,n){var t=this;if(this.expandPanel)return n?(this.expandPanel.active=e,void this.expandPanel.setScale(new h(e?1:0,1,1))):void(e?(this.expandPanel.active=!0,this.syncFromManagers(),this.expandPanel.setScale(new h(0,1,1)),m(this.expandPanel).to(this.animTime,{scale:new h(1,1,1)},{easing:"quadOut"}).start()):m(this.expandPanel).to(this.animTime,{scale:new h(0,1,1)},{easing:"quadIn"}).call((function(){t.expandPanel&&(t.expandPanel.active=!1)})).start())},n}(d)).prototype,"iconBtn",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(M.prototype,"expandPanel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=n(M.prototype,"bgmSlider",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=n(M.prototype,"sfxSlider",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=n(M.prototype,"nextBgmBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(M.prototype,"bgmNameLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(M.prototype,"gm",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(M.prototype,"audioManager",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(M.prototype,"animTime",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.12}}),w=M))||w));a._RF.pop()}}}));

System.register("chunks:///_virtual/AutoLabel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DebugClick.ts"],(function(t){var e,n,o,l,i,r;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,l=t.Label,i=t.Component},function(t){r=t.DebugClick}],execute:function(){var u;n._RF.push({},"3a83bzOYKpFaLDSfPlfKu24","AutoLabel",void 0);var a=o.ccclass;t("AutoLabel",a("AutoLabel")(u=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.start=function(){for(var t=this.node.children,e=0;e<t.length;e++){var n,o=t[e],i=null==(n=o.getChildByName("Btn"))?void 0:n.getChildByName("Label"),u=null==i?void 0:i.getComponent(l);u&&(u.string=e+1+"月");var a=o.getComponent(r);a&&(a.pileIndex=e)}},n}(i))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/CardView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,i,a,s,o,r,h;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t._decorator,a=t.Sprite,s=t.Node,o=t.UITransform,r=t.Vec3,h=t.Component}],execute:function(){var c;n._RF.push({},"aafcbVXyfpC45f7UsA6HV4v","CardView",void 0);var u=i.ccclass;t("CardView",u("CardView")(c=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))||this).monthValue=1,e.sprite=null,e.faceFrame=null,e.backFrame=null,e.draggable=!1,e.manager=null,e.homeWorldPos=new r,e}e(n,t);var i=n.prototype;return i.init=function(t){this.manager=t.manager,this.monthValue=t.monthValue,this.faceFrame=t.faceFrame,this.backFrame=t.backFrame,this.sprite=this.getComponent(a),this.sprite||(this.sprite=this.addComponent(a)),this.setFaceUp(!1),this.setDraggable(!1)},i.setFaceUp=function(t){this.sprite||(this.sprite=this.getComponent(a)),this.sprite&&(t?this.faceFrame&&(this.sprite.spriteFrame=this.faceFrame):this.backFrame&&(this.sprite.spriteFrame=this.backFrame))},i.setDraggable=function(t){this.draggable!==t&&(this.draggable=t,t?(this.node.on(s.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(s.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(s.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(s.EventType.TOUCH_CANCEL,this.onTouchEnd,this)):(this.node.off(s.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(s.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(s.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(s.EventType.TOUCH_CANCEL,this.onTouchEnd,this)))},i.onTouchStart=function(t){var e;null!=(e=this.manager)&&null!=e.isInputLocked&&e.isInputLocked()||this.draggable&&this.manager&&this.manager.onCardDragStart(this)},i.onTouchMove=function(t){var e;if((null==(e=this.manager)||null==e.isInputLocked||!e.isInputLocked())&&this.draggable&&this.manager){var n=t.getUILocation(),i=this.manager.getDragLayer().getComponent(o);if(i){var a=i.convertToNodeSpaceAR(new r(n.x,n.y,0));this.node.setPosition(a)}}},i.onTouchEnd=function(t){var e;if((null==(e=this.manager)||null==e.isInputLocked||!e.isInputLocked())&&this.draggable&&this.manager){var n=t.getUILocation();this.manager.onCardDragEnd(this,n)}},n}(h))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/CollectionPanel.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,r,o,a,l,s,u,c,p,h,f,d,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,l=t.Node,s=t.Sprite,u=t.SpriteFrame,c=t.UIOpacity,p=t.sys,h=t.Tween,f=t.Vec3,d=t.tween,g=t.Component}],execute:function(){var m,y,b,k,v,w,O,S,T,_,C,z,j,A,N,F,B,I,P,E,D,q,H,K,G,L,R,U,V,x,J,M,X;o._RF.push({},"9fa08g+fXNKZLFnfnw4pKRa","CollectionPanel",void 0);var Z=a.ccclass,Q=a.property;t("CollectionPanel",(m=Z("CollectionPanel"),y=Q(l),b=Q(l),k=Q(l),v=Q(l),w=Q([s]),O=Q(u),S=Q(u),T=Q(u),_=Q(u),C=Q(u),z=Q(u),j=Q(u),m(((X=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,n(e,"root",F,r(e)),n(e,"mask",B,r(e)),n(e,"panel",I,r(e)),n(e,"grid",P,r(e)),n(e,"slots",E,r(e)),n(e,"emptySlotFrame",D,r(e)),n(e,"k1",q,r(e)),n(e,"k2",H,r(e)),n(e,"k3",K,r(e)),n(e,"k4",G,r(e)),n(e,"joker1",L,r(e)),n(e,"joker2",R,r(e)),n(e,"fadeTime",U,r(e)),n(e,"maskOpacityTarget",V,r(e)),n(e,"popTime",x,r(e)),n(e,"popStartScale",J,r(e)),n(e,"popOverScale",M,r(e)),e._open=!1,e.storeKey="twelve_month_collection_v1",e.owned={k1:!1,k2:!1,k3:!1,k4:!1,joker1:!1,joker2:!1},e}i(e,t);var o=e.prototype;return o.onLoad=function(){var t=this;this.root||(this.root=this.node),this.root.active=!1,this._open=!1,this.mask&&(this.mask.off(l.EventType.TOUCH_END),this.mask.on(l.EventType.TOUCH_END,(function(e){return t.setOpen(!1)}),this)),this.ensureSlots(),this.load(),this.refresh()},o.open=function(){this.setOpen(!0)},o.close=function(){this.setOpen(!1)},o.addCard=function(t){return this.unlock(t)},o.getCardFrame=function(t){switch(t){case"k1":return this.k1;case"k2":return this.k2;case"k3":return this.k3;case"k4":return this.k4;case"joker1":return this.joker1;case"joker2":return this.joker2;default:return null}},o.isOpen=function(){return this._open},o.toggle=function(){this.setOpen(!this._open)},o.setOpen=function(t){var i=this;t!==this._open&&(this._open=t,this.node.emit(e.EVT_OPEN_CHANGED,this._open),this.root&&(t?(this.root.active=!0,this.bringToFront(),this.ensureSlots(),this.refresh(),this.fadeIn()):this.fadeOut((function(){i.root&&(i.root.active=!1)}))))},o.unlock=function(t){return this.owned[t]?(this.refresh(),!1):(this.owned[t]=!0,this.save(),this.refresh(),!0)},o.refresh=function(){var t,e;(this.ensureSlots(),this.slots&&6===this.slots.length)||console.warn("[CollectionPanel] slots 数量不是 6（当前="+(null!=(t=null==(e=this.slots)?void 0:e.length)?t:0)+"），请在 Inspector 拖满 Slot_1~Slot_6 或设置 grid 让它自动查找");for(var i=[{id:"k1",frame:this.k1},{id:"k2",frame:this.k2},{id:"k3",frame:this.k3},{id:"k4",frame:this.k4},{id:"joker1",frame:this.joker1},{id:"joker2",frame:this.joker2}],n=0;n<6;n++){var r,o=null==(r=this.slots)?void 0:r[n];if(o){var a=o.getComponent(c);a||(a=o.addComponent(c)),a.opacity=255;var l,s=i[n];if(!!this.owned[s.id]&&s.frame)o.spriteFrame=s.frame;else o.spriteFrame=null!=(l=this.emptySlotFrame)?l:null}}},o.ensureSlots=function(){if(!this.slots||6!==this.slots.length||!this.slots.every(Boolean)){var t,e,i=this.grid;if(!i&&this.panel)i=null!=(t=this.panel.getChildByName("Grid"))?t:null;if(!i&&this.root)i=null!=(e=this.root.getChildByName("Grid"))?e:null;if(i){for(var n=[],r=1;r<=6;r++){var o=i.getChildByName("Slot_"+r);if(o){var a=o.getComponent(s);a&&n.push(a)}}6===n.length&&(this.slots=n)}}},o.load=function(){try{var t=p.localStorage.getItem(this.storeKey);if(!t)return;for(var e=JSON.parse(t),i=0,n=Object.keys(this.owned);i<n.length;i++){var r=n[i];"boolean"==typeof e[r]&&(this.owned[r]=e[r])}}catch(t){console.warn("[CollectionPanel] load failed:",t)}},o.save=function(){try{p.localStorage.setItem(this.storeKey,JSON.stringify(this.owned))}catch(t){console.warn("[CollectionPanel] save failed:",t)}},o.bringToFront=function(){var t,e=null==(t=this.root)?void 0:t.parent;e&&this.root&&this.root.setSiblingIndex(e.children.length-1)},o.getOrAddOpacity=function(t){if(!t)return null;var e=t.getComponent(c);return e||(e=t.addComponent(c)),e},o.fadeIn=function(){if(this.panel){var t=this.getOrAddOpacity(this.panel),e=this.getOrAddOpacity(this.mask);t&&h.stopAllByTarget(t),e&&h.stopAllByTarget(e),h.stopAllByTarget(this.panel),e&&(e.opacity=0),t&&(t.opacity=0),this.panel.setScale(new f(this.popStartScale,this.popStartScale,1)),e&&d(e).to(this.fadeTime,{opacity:this.maskOpacityTarget},{easing:"quadOut"}).start(),t&&d(t).to(this.fadeTime,{opacity:255},{easing:"quadOut"}).start(),d(this.panel).to(this.popTime,{scale:new f(this.popOverScale,this.popOverScale,1)},{easing:"backOut"}).to(.08,{scale:new f(1,1,1)},{easing:"quadOut"}).start()}},o.fadeOut=function(t){if(this.panel){var e=this.getOrAddOpacity(this.panel),i=this.getOrAddOpacity(this.mask);e&&h.stopAllByTarget(e),i&&h.stopAllByTarget(i),h.stopAllByTarget(this.panel),d(this.panel).to(.75*this.popTime,{scale:new f(this.popStartScale,this.popStartScale,1)},{easing:"quadIn"}).start(),e&&d(e).to(this.fadeTime,{opacity:0},{easing:"quadIn"}).start(),i?d(i).to(this.fadeTime,{opacity:0},{easing:"quadIn"}).call((function(){return null==t?void 0:t()})).start():d(this.node).delay(this.fadeTime).call((function(){return null==t?void 0:t()})).start()}else null==t||t()},e}(g)).EVT_OPEN_CHANGED="collection_open_changed",F=e((N=X).prototype,"root",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(N.prototype,"mask",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(N.prototype,"panel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(N.prototype,"grid",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(N.prototype,"slots",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=e(N.prototype,"emptySlotFrame",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=e(N.prototype,"k1",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(N.prototype,"k2",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(N.prototype,"k3",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(N.prototype,"k4",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(N.prototype,"joker1",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(N.prototype,"joker2",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(N.prototype,"fadeTime",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.12}}),V=e(N.prototype,"maskOpacityTarget",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 170}}),x=e(N.prototype,"popTime",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.22}}),J=e(N.prototype,"popStartScale",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.86}}),M=e(N.prototype,"popOverScale",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.04}}),A=N))||A));o._RF.pop()}}}));

System.register("chunks:///_virtual/DebugClick.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,n,t,r,o,c,l;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,c=e._decorator,l=e.Component}],execute:function(){var u,a,p;o._RF.push({},"842e6Fv/H1Ps4WMZe4zMlik","DebugClick",void 0);var s=c.ccclass,f=c.property;e("DebugClick",s("DebugClick")((p=i((a=function(e){function i(){for(var i,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return i=e.call.apply(e,[this].concat(o))||this,t(i,"pileIndex",p,r(i)),i}return n(i,e),i.prototype.onClick=function(){console.log("[CLICK] pileIndex="+this.pileIndex)},i}(l)).prototype,"pileIndex",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),u=a))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/GameManagers.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CardView.ts","./CollectionPanel.ts","./WinFireworksShow.ts"],(function(e){var t,i,n,r,a,o,l,s,d,h,u,c,p,f,g,w,b,v,m,P,S,y,C,k,T,x,I,L,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose},function(e){o=e.cclegacy,l=e._decorator,s=e.Node,d=e.Prefab,h=e.SpriteFrame,u=e.AudioClip,c=e.Label,p=e.Button,f=e.Sprite,g=e.AudioSource,w=e.CCString,b=e.Vec2,v=e.UIOpacity,m=e.tween,P=e.sys,S=e.Vec3,y=e.Tween,C=e.UITransform,k=e.instantiate,T=e.EventHandler,x=e.Component},function(e){I=e.CardView},function(e){L=e.CollectionPanel},function(e){F=e.WinFireworksShow}],execute:function(){var R,D,B,z,H,M,_,O,E,N,A,W,U,V,G,Z,Y,K,q,j,X,J,Q,$,ee,te,ie,ne,re,ae,oe,le,se,de,he,ue,ce,pe,fe,ge,we,be,ve,me,Pe,Se,ye,Ce,ke,Te,xe,Ie,Le,Fe,Re,De,Be,ze,He,Me,_e,Oe,Ee,Ne,Ae,We,Ue,Ve,Ge,Ze,Ye,Ke,qe,je,Xe,Je,Qe,$e,et,tt,it,nt,rt,at,ot,lt,st,dt,ht,ut,ct,pt,ft,gt,wt,bt,vt,mt,Pt,St,yt;o._RF.push({},"71b7fWJM9FBuIGiubYWsYsr","GameManagers",void 0);var Ct=l.ccclass,kt=l.property;e("GameManagers",(R=Ct("GameManagers"),D=kt(s),B=kt(d),z=kt([h]),H=kt(s),M=kt(s),_=kt(u),O=kt(u),E=kt([u]),N=kt(s),A=kt(c),W=kt(s),U=kt(F),V=kt(s),G=kt(s),Z=kt(s),Y=kt([p]),K=kt(s),q=kt(s),j=kt(s),X=kt(f),J=kt(s),Q=kt(s),$=kt(s),ee=kt(p),te=kt(p),ie=kt(L),ne=kt(g),re=kt([u]),ae=kt([u]),oe=kt([u]),le=kt([u]),se=kt([u]),de=kt([u]),he=kt({type:[w]}),R((pe=t((ce=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"monthGrid",pe,r(t)),n(t,"cardBackPrefab",fe,r(t)),n(t,"cardFaces",ge,r(t)),n(t,"dragLayer",we,r(t)),n(t,"cardsPerPile",be,r(t)),n(t,"cardWidth",ve,r(t)),n(t,"cardHeight",me,r(t)),n(t,"offsetY",Pe,r(t)),n(t,"flipLiftY",Se,r(t)),n(t,"dropPadding",ye,r(t)),n(t,"snapRadius",Ce,r(t)),n(t,"maxSpan",ke,r(t)),n(t,"backPeek",Te,r(t)),n(t,"dragZoomScale",xe,r(t)),n(t,"dragZoomInTime",Ie,r(t)),n(t,"dragZoomOutTime",Le,r(t)),n(t,"dealFrom",Fe,r(t)),n(t,"dealAnimEnabled",Re,r(t)),n(t,"dealStartDelay",De,r(t)),n(t,"dealInterval",Be,r(t)),n(t,"dealFlyTime",ze,r(t)),n(t,"dealSfx",He,r(t)),n(t,"dealCardSfx",Me,r(t)),n(t,"dealCardSfxPool",_e,r(t)),n(t,"dealCardSfxVolume",Oe,r(t)),n(t,"dealPopScale",Ee,r(t)),n(t,"dealPopUpTime",Ne,r(t)),n(t,"dealPopDownTime",Ae,r(t)),n(t,"winPopup",We,r(t)),n(t,"winSubtitleLabel",Ue,r(t)),n(t,"winFireworks",Ve,r(t)),n(t,"winFireworksShow",Ge,r(t)),n(t,"winTapCatcher",Ze,r(t)),n(t,"winTapEnableDelay",Ye,r(t)),n(t,"winSubtitleShowDelay",Ke,r(t)),n(t,"winSubtitleFadeTime",qe,r(t)),n(t,"losePopup",je,r(t)),n(t,"revivePanel",Xe,r(t)),n(t,"reviveMonthButtons",Je,r(t)),n(t,"reviewPanel",Qe,r(t)),n(t,"rewardPopup",$e,r(t)),n(t,"rewardMask",et,r(t)),n(t,"rewardCardSprite",tt,r(t)),n(t,"rewardFadeTime",it,r(t)),n(t,"rewardScalePop",nt,r(t)),n(t,"loseStep1",rt,r(t)),n(t,"loseStep2",at,r(t)),n(t,"loseMask",ot,r(t)),n(t,"loseIntroDelay",lt,r(t)),n(t,"restartBtn",st,r(t)),n(t,"collectionBtn",dt,r(t)),n(t,"collectionPanel",ht,r(t)),n(t,"sfxSource",ut,r(t)),n(t,"sfxVolume",ct,r(t)),n(t,"monthCompleteSfxPool",pt,r(t)),n(t,"loseSfxPool",ft,r(t)),n(t,"winSfxPerfectPool",gt,r(t)),n(t,"winSfxRevivedPool",wt,r(t)),n(t,"fireworkSmallSfxPool",bt,r(t)),n(t,"fireworkBigSfxPool",vt,r(t)),n(t,"fireworkSmallGap",mt,r(t)),n(t,"fireworkBigDelay",Pt,r(t)),n(t,"winSubtitlePool",St,r(t)),n(t,"reviveVideoUrl",yt,r(t)),t.piles=[],t.backFrame=null,t.activePileIndex=0,t.pendingCard=null,t.pendingTargetPile=-1,t.deck=[],t.firstDrawDone=!1,t.pileHoldDragging=!1,t.pileHoldIndex=-1,t.pileHoldStart=new b,t.pileHoldMoved=!1,t.tapThreshold=8,t.placedCount=0,t.inputLocked=!1,t.state="Playing",t.losePhaseScheduled=!1,t.dealingInProgress=!1,t.revivedThisRound=!1,t.pendingRewardId=null,t.winRewardPending=null,t.winTapArmed=!1,t._dragBaseScale=new Map,t._KEY_SFX_VOL="tm_audio_sfx_volume_v1",t.showWinSubtitle=function(){if(t.winSubtitleLabel){t.winSubtitleLabel.node.active=!0;var e=t.winSubtitleLabel.getComponent(v);e||(e=t.winSubtitleLabel.addComponent(v)),e.opacity=0,m(e).to(t.winSubtitleFadeTime,{opacity:255}).start()}},t.armWinTap=function(){"Won"===t.state&&(t.winTapArmed=!0,t.winTapCatcher&&(t.winTapCatcher.active=!0,t.bringNodeToFront(t.winTapCatcher)),t.bringRestartBarToFront())},t.onWinTap=function(){var e;"Won"===t.state&&t.winTapArmed&&t.winRewardPending&&(t.winTapArmed=!1,t.winTapCatcher&&(t.winTapCatcher.active=!1),null==(e=t.winFireworksShow)||e.stopAndClear(),t.winFireworks&&(t.winFireworks.active=!1),t.showRewardPopup(t.winRewardPending))},t.showLoseMenuStep2=function(){if("Failed"===t.state){if(t.unschedule(t.showLoseMenuStep2),t.losePhaseScheduled=!1,t.loseStep1){var e=t.loseStep1.getComponent(v);e?m(e).to(.2,{opacity:0}).call((function(){t.loseStep1&&(t.loseStep1.active=!1)})).start():t.loseStep1.active=!1}if(t.loseStep2){t.loseStep2.active=!0;var i=t.loseStep2.getComponent(v);i&&(i.opacity=0,m(i).to(.2,{opacity:255}).start())}}},t}i(t,e);var o=t.prototype;return o.start=function(){var e,t=this;try{var i=P.localStorage.getItem(this._KEY_SFX_VOL);if(null!=i&&""!==i){var n=parseFloat(i);Number.isFinite(n)&&(this.sfxVolume=Math.max(0,Math.min(1,n)))}}catch(e){}if(this.ensureDragLayerOnTop(),this.initPiles(),this.buildDeckByName(),this.restartGameInternal(!0),this.restartBtn&&(this.restartBtn.node.off(p.EventType.CLICK),this.restartBtn.node.on(p.EventType.CLICK,this.onRestartClicked,this)),this.collectionBtn&&(this.collectionBtn.node.off(p.EventType.CLICK),this.collectionBtn.node.on(p.EventType.CLICK,this.onCollectionClicked,this)),this.collectionPanel&&(this.collectionPanel.node.off(L.EVT_OPEN_CHANGED),this.collectionPanel.node.on(L.EVT_OPEN_CHANGED,(function(e){if(!!e)t.setInputLocked(!0);else{var i=t.dealingInProgress||"Playing"!==t.state;t.setInputLocked(i),i||t.setActivePile(t.activePileIndex)}t.bringRestartBarToFront()}),this)),this.rewardPopup&&(this.rewardPopup.active=!1),this.rewardMask?(this.rewardMask.off(s.EventType.TOUCH_END),this.rewardMask.on(s.EventType.TOUCH_END,(function(){t.hideRewardPopup(!0)}),this)):this.rewardPopup&&(this.rewardPopup.off(s.EventType.TOUCH_END),this.rewardPopup.on(s.EventType.TOUCH_END,(function(){t.hideRewardPopup(!0)}),this)),this.winTapCatcher&&(this.winTapCatcher.active=!1,this.winTapCatcher.off(s.EventType.TOUCH_END),this.winTapCatcher.on(s.EventType.TOUCH_END,this.onWinTap,this)),this.reviveMonthButtons&&12===this.reviveMonthButtons.length)for(var r=function(e){var i=t.reviveMonthButtons[e];i.node.off(p.EventType.CLICK),i.node.on(p.EventType.CLICK,(function(){return t.onRevivePickMonth(e)}),t)},a=0;a<12;a++)r(a);this.loseMask&&(this.loseMask.off(s.EventType.TOUCH_END),this.loseMask.on(s.EventType.TOUCH_END,(function(){"Failed"===t.state&&t.showLoseMenuStep2()}),this)),this.winFireworks&&(this.winFireworks.active=!1),this.winSubtitleLabel&&(this.winSubtitleLabel.node.active=!1),this.winTapCatcher&&(this.winTapCatcher.active=!1),null==(e=this.winFireworksShow)||e.stopAndClear(),this.bringRestartBarToFront()},o.setSfxVolume=function(e){e=Math.max(0,Math.min(1,e)),this.sfxVolume=e;try{P.localStorage.setItem(this._KEY_SFX_VOL,String(e))}catch(e){}},o.getSfxVolume=function(){return this.sfxVolume},o._dragZoomIn=function(e){var t=e.node;this._dragBaseScale.has(t)||this._dragBaseScale.set(t,t.scale.clone());var i=this._dragBaseScale.get(t),n=new S(i.x*this.dragZoomScale,i.y*this.dragZoomScale,i.z);y.stopAllByTarget(t),m(t).to(this.dragZoomInTime,{scale:n},{easing:"quadOut"}).start()},o._dragZoomOut=function(e){var t=e.node,i=this._dragBaseScale.get(t);i&&(y.stopAllByTarget(t),m(t).to(this.dragZoomOutTime,{scale:i.clone()},{easing:"quadOut"}).start())},o.ensureDragLayerOnTop=function(){if(this.dragLayer){var e=this.dragLayer.parent;e&&this.dragLayer.setSiblingIndex(e.children.length-1)}},o.bringNodeToFront=function(e){if(e){var t=e.parent;t&&e.setSiblingIndex(t.children.length-1)}},o.getDragLayer=function(){var e,t=null!=(e=this.dragLayer)?e:this.node;return t.getComponent(C)?t:this.node},o.totalCards=function(){return this.piles.length*this.cardsPerPile},o.pickRandom=function(e){var t;return e&&0!==e.length&&null!=(t=e[Math.floor(Math.random()*e.length)])?t:null},o.playSfx=function(e,t){if(void 0===t&&(t=1),this.sfxSource&&e){var i=Math.max(0,Math.min(1,t*this.sfxVolume));this.sfxSource.playOneShot(e,i)}},o.playSfxRandom=function(e,t){if(void 0===t&&(t=1),this.sfxSource){var i=this.pickRandom(e);if(i){var n=Math.max(0,Math.min(1,t*this.sfxVolume));this.sfxSource.playOneShot(i,n)}}},o.playDealCardSfx=function(){this.dealCardSfxPool&&this.dealCardSfxPool.length>0?this.playSfxRandom(this.dealCardSfxPool,this.dealCardSfxVolume):this.dealCardSfx&&this.playSfx(this.dealCardSfx,this.dealCardSfxVolume)},o.popupScalePop=function(e,t){var i=new S(t.x*this.dealPopScale,t.y*this.dealPopScale,t.z);e.setScale(t),m(e).to(this.dealPopUpTime,{scale:i},{easing:"quadOut"}).to(this.dealPopDownTime,{scale:t},{easing:"quadIn"}).start()},o.hideWinSubtitleInstant=function(){if(this.winSubtitleLabel){this.winSubtitleLabel.node.active=!0;var e=this.winSubtitleLabel.getComponent(v);e||(e=this.winSubtitleLabel.addComponent(v)),e.opacity=0}},o.showRewardPopup=function(e){var t,i,n;if(this.pendingRewardId=e,!this.rewardPopup)return this.forcePopup("none"),void(null==(n=this.collectionPanel)||n.setOpen(!0));var r=null!=(t=null==(i=this.collectionPanel)?void 0:i.getCardFrame(e))?t:null;if(this.rewardCardSprite){this.rewardCardSprite.spriteFrame=r;var a=this.rewardCardSprite.getComponent(v);a||(a=this.rewardCardSprite.addComponent(v)),a.opacity=255}this.rewardPopup.active=!0,this.bringNodeToFront(this.rewardPopup),this.bringRestartBarToFront();var o=this.rewardPopup.getComponent(v);if(o||(o=this.rewardPopup.addComponent(v)),o.opacity=0,m(o).to(this.rewardFadeTime,{opacity:255}).start(),this.rewardCardSprite){var l=this.rewardCardSprite.node,s=l.scale.clone(),d=new S(s.x*this.rewardScalePop,s.y*this.rewardScalePop,s.z);l.setScale(s),m(l).to(.08,{scale:d},{easing:"quadOut"}).to(.1,{scale:s},{easing:"quadIn"}).start()}this.setInputLocked(!0)},o.hideRewardPopup=function(e){var t=this;if(this.rewardPopup&&this.rewardPopup.active){var i=this.rewardPopup.getComponent(v);i||(i=this.rewardPopup.addComponent(v)),m(i).to(this.rewardFadeTime,{opacity:0}).call((function(){if(t.rewardPopup&&(t.rewardPopup.active=!1),e){var i;t.forcePopup("none"),null==(i=t.collectionPanel)||i.setOpen(!0)}else{var n=t.dealingInProgress||"Playing"!==t.state;t.setInputLocked(n),n||t.setActivePile(t.activePileIndex)}t.bringRestartBarToFront()})).start()}else{var n;e&&(this.forcePopup("none"),null==(n=this.collectionPanel)||n.setOpen(!0))}},o.initPiles=function(){var e=this;if(this.monthGrid){var t=this.monthGrid.children.slice().filter((function(e){return e.name.startsWith("Pile_")})).sort((function(t,i){return e.extractPileIndex(t.name)-e.extractPileIndex(i.name)}));this.piles=[];for(var i=0;i<t.length;i++){var n=t[i],r=n.getChildByName("CardsRoot");if(r){var a=r.position.y,o=n.getChildByName("PlacedRoot");if(o||(o=new s("PlacedRoot")).setParent(n),!o.getComponent(C))o.addComponent(C).setContentSize(this.cardWidth,this.cardHeight);var l=this.bindBtnClickAndHold(n,i),d=l.btn,h=l.btnNode;h&&h.setSiblingIndex(n.children.length-1),this.piles.push({pileNode:n,btn:d,btnNode:h,hiddenRoot:r,hidden:[],placedRoot:o,placed:[],baseHiddenY:a})}else console.error("[GameManagers] "+n.name+" 找不到 CardsRoot（名字必须叫 CardsRoot）")}}else console.error("[GameManagers] monthGrid 未设置")},o.buildDeckByName=function(){for(var e,t=this.piles.length*this.cardsPerPile,i=new Map,n=a(this.cardFaces);!(e=n()).done;){var r=e.value,o=this.parseCardNo(r);o<=0||(i.has(o)||i.set(o,r))}for(var l=1;l<=t;l++)if(!i.has(l))return console.error("[GameManagers] 缺少 card_"+l+"（检查命名/是否拖进 cardFaces）"),void(this.deck=[]);for(var s=[],d=1;d<=t;d++){var h=Math.floor((d-1)/4)+1;s.push({face:i.get(d),month:h,cardNo:d})}this.shuffle(s),this.deck=s},o.parseCardNo=function(e){var t=((null==e?void 0:e.name)||"").trim().match(/card[\s_-]?(\d+)/i);if(!t)return-1;var i=parseInt(t[1],10);return Number.isFinite(i)?i:-1},o.clearAllCards=function(){for(var e,t=a(this.piles);!(e=t()).done;){for(var i,n=e.value,r=a(n.hidden);!(i=r()).done;){i.value.node.destroy()}for(var o,l=a(n.placed);!(o=l()).done;){o.value.node.destroy()}n.hidden=[],n.placed=[]}this.pendingCard=null,this.pendingTargetPile=-1,this.firstDrawDone=!1,this.placedCount=0,this.pileHoldDragging=!1,this.pileHoldIndex=-1,this.pileHoldMoved=!1,this._dragBaseScale.clear()},o.ensureBackFrameReady=function(){var e;if(!this.backFrame&&this.cardBackPrefab){var t=k(this.cardBackPrefab),i=t.getComponent(f);this.backFrame=null!=(e=null==i?void 0:i.spriteFrame)?e:null,t.destroy()}},o.dealNewRound=function(){this.cardBackPrefab?0!==this.deck.length?(this.clearAllCards(),this.ensureBackFrameReady(),this.state="Playing",this.setInputLocked(!0),this.forcePopup("none"),this.initLoseStepsDefault(),this.hideRewardPopup(!1),this.dealAnimEnabled&&this.dealFrom&&this.backFrame?this.dealAnimated():(this.dealInstant(),this.dealingInProgress=!1,this.setInputLocked(!1),this.setActivePile(0))):console.error("[GameManagers] deck 为空：检查 cardFaces 是否齐全且命名正确"):console.error("[GameManagers] cardBackPrefab 未设置")},o.dealInstant=function(){for(var e=0,t=0;t<this.piles.length;t++){for(var i=this.piles[t],n=0;n<this.cardsPerPile;n++){var r=this.deck[e++],a=k(this.cardBackPrefab);a.name="H_"+t+"_"+n+"_card"+r.cardNo,a.setParent(i.hiddenRoot);var o=a.getComponent(I)||a.addComponent(I);o.init({manager:this,monthValue:r.month,faceFrame:r.face,backFrame:this.backFrame}),o.setFaceUp(!1),o.setDraggable(!1),i.hidden.push(o)}this.relayoutHidden(t),this.relayoutPlaced(t),this.updateHiddenPeek(t)}},o.dealAnimated=function(){var e=this;this.dealingInProgress=!0,this.playSfx(this.dealSfx,.9);var t=this.getDragLayer(),i=t.getComponent(C);if(!i)return this.dealInstant(),this.dealingInProgress=!1,this.setInputLocked(!1),void this.setActivePile(0);for(var n=0,r=[],a=0;a<this.piles.length;a++){r[a]=[];for(var o=0;o<this.cardsPerPile;o++)r[a][o]=this.deck[n++]}for(var l=this.dealFrom.worldPosition,s=i.convertToNodeSpaceAR(l),d=this.effectiveOffset(this.cardsPerPile),h=this.piles.length*this.cardsPerPile,u=0,c=0;c<this.cardsPerPile;c++)for(var p=function(){var n=e.piles[f],a=r[f][c],o=k(e.cardBackPrefab);o.name="H_"+f+"_"+c+"_card"+a.cardNo,o.setParent(t),o.setPosition(s);var l=o.scale.clone(),h=o.getComponent(I)||o.addComponent(I);h.init({manager:e,monthValue:a.month,faceFrame:a.face,backFrame:e.backFrame}),h.setFaceUp(!1),h.setDraggable(!1),n.hidden.push(h);var p=-(e.cardsPerPile-1-c)*d,g=new S(0,p,0),w=n.hiddenRoot.getComponent(C),b=new S(0,0,0);if(w){var v=w.convertToWorldSpaceAR(g);b=i.convertToNodeSpaceAR(v)}var P=e.dealStartDelay+u*e.dealInterval;u++,m(o).delay(P).to(e.dealFlyTime,{position:b},{easing:"quadOut"}).call((function(){o.setParent(n.hiddenRoot),o.setPosition(g),e.popupScalePop(o,l),e.playDealCardSfx()})).start()},f=0;f<this.piles.length;f++)p();var g=this.dealStartDelay+(h-1)*this.dealInterval+this.dealFlyTime+.12;this.scheduleOnce((function(){for(var t=0;t<e.piles.length;t++)e.relayoutHidden(t),e.relayoutPlaced(t),e.updateHiddenPeek(t);e.dealingInProgress=!1,e.setInputLocked(!1),e.setActivePile(0)}),g)},o.setInputLocked=function(e){this.inputLocked=e,e&&(this.pileHoldDragging=!1,this.pileHoldIndex=-1,this.pileHoldMoved=!1,this.pileHoldStart.set(0,0));for(var t=0;t<this.piles.length;t++){var i=this.piles[t].btn;i&&(e||this.pendingCard?i.interactable=!1:i.interactable=t===this.activePileIndex)}e&&this.pendingCard&&this.pendingCard.setDraggable(!1)},o.setActivePile=function(e){if(this.activePileIndex=e,this.inputLocked||"Playing"!==this.state)for(var t=0;t<this.piles.length;t++){var i=this.piles[t].btn;i&&(i.interactable=!1)}else{for(var n=0;n<this.piles.length;n++){var r=this.piles[n].btn;r&&(this.pendingCard?r.interactable=!1:r.interactable=n===this.activePileIndex)}this.dealingInProgress||this.checkImmediateLose()}},o.onPileClicked=function(e,t){if(!this.inputLocked&&"Playing"===this.state){var i=parseInt(t,10);this.pendingCard||i===this.activePileIndex&&(this.firstDrawDone||0===i&&(this.drawBottomCardToDrag(i),this.firstDrawDone=!0))}},o.onPileHoldStart=function(e,t){this.inputLocked||"Playing"!==this.state||this.pendingCard||e===this.activePileIndex&&this.firstDrawDone&&(this.drawBottomCardToDrag(e),this.pendingCard&&(this._dragZoomIn(this.pendingCard),this.pileHoldDragging=!0,this.pileHoldIndex=e,this.pileHoldStart=t.getUILocation(),this.pileHoldMoved=!1,this.setNodePosByUI(this.pendingCard.node,this.pileHoldStart,this.flipLiftY),this.pendingCard.homeWorldPos=this.pendingCard.node.worldPosition.clone()))},o.onPileHoldMove=function(e,t){if(!this.inputLocked&&"Playing"===this.state&&this.pileHoldDragging&&e===this.pileHoldIndex&&this.pendingCard){var i=t.getUILocation(),n=i.x-this.pileHoldStart.x,r=i.y-this.pileHoldStart.y;!this.pileHoldMoved&&n*n+r*r>this.tapThreshold*this.tapThreshold&&(this.pileHoldMoved=!0),this.setNodePosByUI(this.pendingCard.node,i,0)}},o.onPileHoldEnd=function(e,t){if(!this.inputLocked&&"Playing"===this.state&&this.pileHoldDragging&&e===this.pileHoldIndex&&(this.pileHoldDragging=!1,this.pileHoldIndex=-1,this.pendingCard))if(this.pileHoldMoved){var i=t.getUILocation();this.onCardDragEnd(this.pendingCard,i)}else this._dragZoomOut(this.pendingCard)},o.drawBottomCardToDrag=function(e){var t=this.piles[e];if(t)if(0!==t.hidden.length){var i=t.hidden.shift(),n=i.node.worldPosition.clone();this.relayoutHidden(e),this.updateHiddenPeek(e),i.setFaceUp(!0),i.node.setParent(this.getDragLayer()),i.node.setWorldPosition(new S(n.x,n.y+this.flipLiftY,n.z)),i.node.setSiblingIndex(this.getDragLayer().children.length-1),i.homeWorldPos=i.node.worldPosition.clone(),this.pendingCard=i,this.pendingTargetPile=i.monthValue-1,i.setDraggable(!0),this.setActivePile(this.activePileIndex)}else"Playing"===this.state&&this.placedCount<this.totalCards()&&this.triggerLose()},o.onCardDragStart=function(e){this.inputLocked||"Playing"!==this.state||this.pendingCard&&e===this.pendingCard&&(e.node.setSiblingIndex(this.getDragLayer().children.length-1),this._dragZoomIn(e))},o.onCardDragEnd=function(e,t){if(!this.inputLocked&&"Playing"===this.state&&this.pendingCard&&e===this.pendingCard){this._dragZoomOut(e);var i=this.findPileByPoint(t);if(null!==i)if(i===this.pendingTargetPile){var n=this.piles[i];e.setDraggable(!1),e.node.setParent(n.placedRoot),n.placed.push(e),this.relayoutPlaced(i),this.updateHiddenPeek(i),this.placedCount+=1,n.placed.length===this.cardsPerPile&&this.playSfxRandom(this.monthCompleteSfxPool,1),this.pendingCard=null,this.pendingTargetPile=-1,this.setActivePile(i),"Playing"===this.state&&this.placedCount>=this.totalCards()&&this.triggerWin()}else e.node.setWorldPosition(e.homeWorldPos);else e.node.setWorldPosition(e.homeWorldPos)}},o.setNodePosByUI=function(e,t,i){var n=this.getDragLayer().getComponent(C);if(n){var r=n.convertToNodeSpaceAR(new S(t.x,t.y,0));r.y+=i,e.setPosition(r)}},o.effectiveOffset=function(e){if(e<=1)return 0;var t=this.maxSpan/(e-1);return Math.min(this.offsetY,t)},o.relayoutHidden=function(e){var t=this.piles[e],i=t.hidden.length,n=this.effectiveOffset(i),r=t.hiddenRoot.getComponent(C);r&&r.setContentSize(this.cardWidth,this.cardHeight+Math.max(0,i-1)*n);for(var a=0;a<i;a++){var o=i-1-a,l=t.hidden[a].node;l.setPosition(new S(0,-o*n,0)),l.setSiblingIndex(a)}},o.relayoutPlaced=function(e){var t=this.piles[e],i=t.placed.length,n=this.effectiveOffset(i),r=t.placedRoot.getComponent(C);r&&r.setContentSize(this.cardWidth,this.cardHeight+Math.max(0,i-1)*n);for(var a=0;a<i;a++){var o=i-1-a,l=t.placed[a].node;l.setPosition(new S(0,-o*n,0)),l.setSiblingIndex(a)}},o.updateHiddenPeek=function(e){var t=this.piles[e];if(t){var i=t.hidden.length,n=t.placed.length,r=t.hiddenRoot.position.x,a=t.hiddenRoot.position.z;if(t.hiddenRoot.setPosition(new S(r,t.baseHiddenY,a)),!(i<=0||n<=0)){var o=(i-1)*this.effectiveOffset(i),l=(n-1)*this.effectiveOffset(n);if(o<=l){var s=l-o+this.backPeek;t.hiddenRoot.setPosition(new S(r,t.baseHiddenY-s,a))}}}},o.findPileByPoint=function(e){for(var t=new b(e.x,e.y),i=-1,n=1/0,r=0;r<this.piles.length;r++){var a=this.piles[r].pileNode.getComponent(C);if(a){var o=a.getBoundingBoxToWorld(),l=o.x-this.dropPadding,s=o.y-this.dropPadding,d=o.width+2*this.dropPadding,h=o.height+2*this.dropPadding;if(t.x>=l&&t.x<=l+d&&t.y>=s&&t.y<=s+h)return r;var u=o.x+.5*o.width,c=o.y+.5*o.height,p=t.x-u,f=t.y-c,g=p*p+f*f;g<n&&(n=g,i=r)}}if(i>=0&&Math.sqrt(n)<=this.snapRadius)return i;return null},o.forcePopup=function(e){var t;(this.winPopup&&(this.winPopup.active="win"===e),this.losePopup&&(this.losePopup.active="lose"===e),this.revivePanel&&(this.revivePanel.active="revive"===e),this.reviewPanel&&(this.reviewPanel.active=!1),"win"!==e)?(this.unschedule(this.showWinSubtitle),this.unschedule(this.armWinTap),this.winTapArmed=!1,this.winRewardPending=null,this.winTapCatcher&&(this.winTapCatcher.active=!1),null==(t=this.winFireworksShow)||t.stopAndClear(),this.winFireworks&&(this.winFireworks.active=!1),this.winSubtitleLabel&&(this.winSubtitleLabel.node.active=!1)):(this.winFireworks&&(this.winFireworks.active=!1,this.winFireworks.active=!0),this.winTapCatcher&&(this.winTapCatcher.active=!1),this.winSubtitleLabel&&(this.winSubtitleLabel.node.active=!0));this.bringRestartBarToFront()},o.triggerWin=function(){var e;if("Playing"===this.state){this.state="Won",this.setInputLocked(!0);var t=this.grantCollectionReward(),i=null!=(e=this.pickRandom(this.winSubtitlePool))?e:"新年快乐！";this.winSubtitleLabel&&(this.winSubtitleLabel.string=i),this.winRewardPending=t,this.winTapArmed=!1,this.winTapCatcher&&(this.winTapCatcher.active=!1),this.forcePopup("win"),this.revivedThisRound?this.playSfxRandom(this.winSfxRevivedPool,1):this.playSfxRandom(this.winSfxPerfectPool,1),this.playFireworksSfx(),this.winFireworks&&(this.winFireworks.active=!0),this.winFireworksShow?(this.winFireworksShow.subtitleLabel=null,this.winFireworksShow.subtitleGlow=null,this.winFireworksShow.stopAndClear(),this.winFireworksShow.play(i,{onSubtitle:function(){},onDone:function(){}})):console.warn("[GameManagers] winFireworksShow 没绑定（Inspector 里把 WinFireworksShow 组件拖进来）"),this.hideWinSubtitleInstant(),this.unschedule(this.showWinSubtitle),this.unschedule(this.armWinTap),this.scheduleOnce(this.showWinSubtitle,this.winSubtitleShowDelay);var n=Math.max(this.winTapEnableDelay,this.winSubtitleShowDelay);this.scheduleOnce(this.armWinTap,n)}},o.playFireworksSfx=function(){var e=this;if(this.sfxSource){for(var t=this.fireworkSmallSfxPool&&this.fireworkSmallSfxPool.length>0,i=this.fireworkBigSfxPool&&this.fireworkBigSfxPool.length>0,n=0;n<4&&t;n++)this.scheduleOnce((function(){e.playSfxRandom(e.fireworkSmallSfxPool,1)}),n*this.fireworkSmallGap);if(i){var r=4*this.fireworkSmallGap+this.fireworkBigDelay;this.scheduleOnce((function(){e.playSfxRandom(e.fireworkBigSfxPool,1)}),r)}}},o.triggerLose=function(){"Playing"===this.state&&(this.state="Failed",this.setInputLocked(!0),this.forcePopup("lose"),this.initLoseStepsDefault(),this.playSfxRandom(this.loseSfxPool,1),this.scheduleLoseStep2())},o.checkImmediateLose=function(){if(!this.dealingInProgress&&"Playing"===this.state&&!(this.pendingCard||this.placedCount>=this.totalCards())){var e=this.piles[this.activePileIndex];e&&0===e.hidden.length&&this.triggerLose()}},o.initLoseStepsDefault=function(){if(this.loseStep1){this.loseStep1.active=!0;var e=this.loseStep1.getComponent(v);e&&(e.opacity=255)}if(this.loseStep2){this.loseStep2.active=!1;var t=this.loseStep2.getComponent(v);t&&(t.opacity=0)}this.unschedule(this.showLoseMenuStep2),this.losePhaseScheduled=!1},o.scheduleLoseStep2=function(){this.losePhaseScheduled||(this.losePhaseScheduled=!0,this.scheduleOnce(this.showLoseMenuStep2,this.loseIntroDelay))},o.onRestartClicked=function(){this.restartGameInternal(!1)},o.onWinRestartClicked=function(){this.restartGameInternal(!1)},o.onLoseRestartClicked=function(){this.restartGameInternal(!1)},o.onLoseWatchVideoClicked=function(){this.reviveVideoUrl&&this.reviveVideoUrl.trim().length>0&&P.openURL(this.reviveVideoUrl.trim()),this.openRevivePanel()},o.openRevivePanel=function(){if("Failed"===this.state&&(this.revivedThisRound=!0,this.state="Reviving",this.setInputLocked(!0),this.forcePopup("revive"),this.reviveMonthButtons&&12===this.reviveMonthButtons.length))for(var e=0;e<12;e++){var t,i=(null==(t=this.piles[e])||null==(t=t.hidden)?void 0:t.length)>0;this.reviveMonthButtons[e].interactable=!!i}},o.onRevivePickMonth=function(e){var t;"Reviving"===this.state&&((null==(t=this.piles[e])||null==(t=t.hidden)?void 0:t.length)>0&&(this.state="Playing",this.forcePopup("none"),this.setInputLocked(!1),this.setActivePile(e)))},o.restartGameInternal=function(e){var t;this.unschedule(this.showLoseMenuStep2),this.losePhaseScheduled=!1,this.dealingInProgress=!1,this.unschedule(this.showWinSubtitle),this.unschedule(this.armWinTap),this.winTapArmed=!1,this.winRewardPending=null,this.winTapCatcher&&(this.winTapCatcher.active=!1),null==(t=this.winFireworksShow)||t.stopAndClear(),this.winFireworks&&(this.winFireworks.active=!1),this.winSubtitleLabel&&(this.winSubtitleLabel.node.active=!1),this.setInputLocked(!0),this.revivedThisRound=!1,this.pendingRewardId=null,this.hideRewardPopup(!1),this.collectionPanel&&this.collectionPanel.isOpen&&this.collectionPanel.isOpen()&&this.collectionPanel.setOpen(!1),this.pendingCard&&(this.pendingCard.setDraggable(!1),this.pendingCard=null,this.pendingTargetPile=-1),this.buildDeckByName(),this.dealNewRound()},o.bringRestartBarToFront=function(){if(this.restartBtn){var e=this.restartBtn.node.parent;if(e){var t=e.parent;t&&(e.setSiblingIndex(t.children.length-1),this.restartBtn.node.setSiblingIndex(e.children.length-1))}}},o.grantCollectionReward=function(){var e,t,i=this.revivedThisRound?null!=(e=this.pickRandom(["k1","k2","k3","k4"]))?e:"k1":null!=(t=this.pickRandom(["joker1","joker2"]))?t:"joker1";return this.collectionPanel&&this.collectionPanel.unlock(i),i},o.onCollectionClicked=function(){this.collectionPanel&&(this.pendingCard||this.pileHoldDragging||(this.collectionPanel.toggle(),this.bringRestartBarToFront()))},o.bindBtnClickAndHold=function(e,t){var i=this,n=e.getChildByName("Btn");if(!n)return{btn:null,btnNode:null};var r=n.getComponent(p);if(!r)return{btn:null,btnNode:n};var a=new T;return a.target=this.node,a.component="GameManagers",a.handler="onPileClicked",a.customEventData=String(t),r.clickEvents=[a],n.on(s.EventType.TOUCH_START,(function(e){return i.onPileHoldStart(t,e)}),this),n.on(s.EventType.TOUCH_MOVE,(function(e){return i.onPileHoldMove(t,e)}),this),n.on(s.EventType.TOUCH_END,(function(e){return i.onPileHoldEnd(t,e)}),this),n.on(s.EventType.TOUCH_CANCEL,(function(e){return i.onPileHoldEnd(t,e)}),this),{btn:r,btnNode:n}},o.extractPileIndex=function(e){var t=e.match(/Pile_(\d+)/);return t?parseInt(t[1],10):999},o.shuffle=function(e){for(var t=e.length-1;t>0;t--){var i=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[i],e[i]=n}},t}(x)).prototype,"monthGrid",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=t(ce.prototype,"cardBackPrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=t(ce.prototype,"cardFaces",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),we=t(ce.prototype,"dragLayer",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=t(ce.prototype,"cardsPerPile",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),ve=t(ce.prototype,"cardWidth",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 160}}),me=t(ce.prototype,"cardHeight",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 252}}),Pe=t(ce.prototype,"offsetY",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 12}}),Se=t(ce.prototype,"flipLiftY",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),ye=t(ce.prototype,"dropPadding",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),Ce=t(ce.prototype,"snapRadius",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 260}}),ke=t(ce.prototype,"maxSpan",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 220}}),Te=t(ce.prototype,"backPeek",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),xe=t(ce.prototype,"dragZoomScale",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.1}}),Ie=t(ce.prototype,"dragZoomInTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.06}}),Le=t(ce.prototype,"dragZoomOutTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.08}}),Fe=t(ce.prototype,"dealFrom",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=t(ce.prototype,"dealAnimEnabled",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),De=t(ce.prototype,"dealStartDelay",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.15}}),Be=t(ce.prototype,"dealInterval",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.03}}),ze=t(ce.prototype,"dealFlyTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.18}}),He=t(ce.prototype,"dealSfx",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(ce.prototype,"dealCardSfx",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=t(ce.prototype,"dealCardSfxPool",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Oe=t(ce.prototype,"dealCardSfxVolume",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.7}}),Ee=t(ce.prototype,"dealPopScale",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.08}}),Ne=t(ce.prototype,"dealPopUpTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.06}}),Ae=t(ce.prototype,"dealPopDownTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.08}}),We=t(ce.prototype,"winPopup",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=t(ce.prototype,"winSubtitleLabel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=t(ce.prototype,"winFireworks",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=t(ce.prototype,"winFireworksShow",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(ce.prototype,"winTapCatcher",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(ce.prototype,"winTapEnableDelay",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.2}}),Ke=t(ce.prototype,"winSubtitleShowDelay",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.85}}),qe=t(ce.prototype,"winSubtitleFadeTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.18}}),je=t(ce.prototype,"losePopup",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(ce.prototype,"revivePanel",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(ce.prototype,"reviveMonthButtons",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qe=t(ce.prototype,"reviewPanel",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(ce.prototype,"rewardPopup",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(ce.prototype,"rewardMask",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=t(ce.prototype,"rewardCardSprite",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=t(ce.prototype,"rewardFadeTime",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.12}}),nt=t(ce.prototype,"rewardScalePop",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.08}}),rt=t(ce.prototype,"loseStep1",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(ce.prototype,"loseStep2",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ot=t(ce.prototype,"loseMask",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt=t(ce.prototype,"loseIntroDelay",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.2}}),st=t(ce.prototype,"restartBtn",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=t(ce.prototype,"collectionBtn",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ht=t(ce.prototype,"collectionPanel",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ut=t(ce.prototype,"sfxSource",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ct=t(ce.prototype,"sfxVolume",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),pt=t(ce.prototype,"monthCompleteSfxPool",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ft=t(ce.prototype,"loseSfxPool",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gt=t(ce.prototype,"winSfxPerfectPool",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),wt=t(ce.prototype,"winSfxRevivedPool",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bt=t(ce.prototype,"fireworkSmallSfxPool",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vt=t(ce.prototype,"fireworkBigSfxPool",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mt=t(ce.prototype,"fireworkSmallGap",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.06}}),Pt=t(ce.prototype,"fireworkBigDelay",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.42}}),St=t(ce.prototype,"winSubtitlePool",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return["池畏99！","雷朋99！","新年快乐！","爱情伟大！"]}}),yt=t(ce.prototype,"reviveVideoUrl",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ue=ce))||ue));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioManager.ts","./AudioSettingsPanel.ts","./AutoLabel.ts","./CardView.ts","./CollectionPanel.ts","./DebugClick.ts","./GameManagers.ts","./OrientationManager.ts","./PileView.ts","./StartGate.ts","./WinFireworksShow.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/OrientationManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,i,t,r,o,a,s,l,c,u;return{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.Canvas,l=e.view,c=e.ResolutionPolicy,u=e.Component}],execute:function(){var p,d,f,h,g,y,v;o._RF.push({},"da8d324Ii1KCpua2atrBDqg","OrientationManager",void 0);var w=a.ccclass,z=a.property;e("OrientationManager",(p=w("OrientationManager"),d=z(s),p((g=n((h=function(e){function n(){for(var n,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,t(n,"canvas",g,r(n)),t(n,"designW",y,r(n)),t(n,"designH",v,r(n)),n.onResize=function(){n.scheduleOnce((function(){return n.applyShowAll()}),0)},n}i(n,e);var o=n.prototype;return o.start=function(){this.applyShowAll(),"undefined"!=typeof window&&window.addEventListener("resize",this.onResize)},o.onDestroy=function(){"undefined"!=typeof window&&window.removeEventListener("resize",this.onResize)},o.applyShowAll=function(){l.setDesignResolutionSize(this.designW,this.designH,c.SHOW_ALL),this.canvas&&(this.canvas.fitWidth=!0,this.canvas.fitHeight=!0)},n}(u)).prototype,"canvas",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=n(h.prototype,"designW",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1280}}),v=n(h.prototype,"designH",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 720}}),f=h))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/PileView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,r,o,l,a,u,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,l=e._decorator,a=e.Button,u=e.Label,c=e.Component}],execute:function(){var s,p,b,h,f,y,d;o._RF.push({},"025b7AYialM7ZN9FZPTbP7R","PileView",void 0);var v=l.ccclass,P=l.property;e("PileView",(s=v("PileView"),p=P(a),b=P(u),s((y=t((f=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,i(t,"btn",y,r(t)),i(t,"label",d,r(t)),t.monthIndex=0,t}n(t,e);var o=t.prototype;return o.bind=function(e,t){var n=this;this.monthIndex=e,this.btn&&(this.btn.node.off(a.EventType.CLICK),this.btn.node.on(a.EventType.CLICK,(function(){return t(n.monthIndex)}),this))},o.setText=function(e){this.label&&(this.label.string=e)},t}(c)).prototype,"btn",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=t(f.prototype,"label",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=f))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/StartGate.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts"],(function(t){var e,i,a,n,r,o,l,u,s,c,p,h,f,g,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,l=t.Node,u=t.Button,s=t.AudioSource,c=t.AudioClip,p=t.BlockInputEvents,h=t.UIOpacity,f=t.tween,g=t.Component},function(t){m=t.AudioManager}],execute:function(){var b,d,y,S,v,R,P,C,k,w,x,z,B,M,_,L,T,A,I,O;r._RF.push({},"eee45K/3x9FZqhXRxHmULiu","StartGate",void 0);var G=o.ccclass,D=o.property;t("StartGate",(b=G("StartGate"),d=D(l),y=D(u),S=D(l),v=D(l),R=D(s),P=D(c),C=D(s),k=D(m),b((z=e((x=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,a(e,"startPanel",z,n(e)),a(e,"startBtn",B,n(e)),a(e,"gameRoot",M,n(e)),a(e,"uiRoot",_,n(e)),a(e,"sfxSource",L,n(e)),a(e,"clickSfx",T,n(e)),a(e,"bgmSource",A,n(e)),a(e,"audioManager",I,n(e)),a(e,"fadeOutTime",O,n(e)),e._clicked=!1,e}i(e,t);var r=e.prototype;return r.onLoad=function(){this.startPanel||(this.startPanel=this.node),this.startPanel&&!this.startPanel.getComponent(p)&&this.startPanel.addComponent(p),this.startPanel&&!this.startPanel.getComponent(h)?this.startPanel.addComponent(h).opacity=255:this.startPanel&&(this.startPanel.getComponent(h).opacity=255),this.gameRoot&&(this.gameRoot.active=!1),this.uiRoot&&(this.uiRoot.active=!1)},r.start=function(){this.startBtn&&(this.startBtn.node.off(u.EventType.CLICK),this.startBtn.node.on(u.EventType.CLICK,this.onStartClicked,this))},r.onStartClicked=function(){var t=this;if(!this._clicked){if(this._clicked=!0,this.startBtn&&(this.startBtn.interactable=!1),this.sfxSource&&this.clickSfx&&this.sfxSource.playOneShot(this.clickSfx,1),this.audioManager?this.audioManager.startBgm():this.bgmSource&&!this.bgmSource.playing&&this.bgmSource.play(),!this.startPanel)return this.gameRoot&&(this.gameRoot.active=!0),void(this.uiRoot&&(this.uiRoot.active=!0));var e=this.startPanel.getComponent(h);e.opacity=255,f(e).to(this.fadeOutTime,{opacity:0}).call((function(){t.startPanel&&(t.startPanel.active=!1),t.gameRoot&&(t.gameRoot.active=!0),t.uiRoot&&(t.uiRoot.active=!0)})).start()}},e}(g)).prototype,"startPanel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(x.prototype,"startBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(x.prototype,"gameRoot",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(x.prototype,"uiRoot",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(x.prototype,"sfxSource",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(x.prototype,"clickSfx",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(x.prototype,"bgmSource",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(x.prototype,"audioManager",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(x.prototype,"fadeOutTime",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.22}}),w=x))||w));r._RF.pop()}}}));

System.register("chunks:///_virtual/WinFireworksShow.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,r,l,a,o,s,u,c,b,p,f,h,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,l=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,o=e._decorator,s=e.Node,u=e.Label,c=e.ParticleSystem2D,b=e.instantiate,p=e.Vec3,f=e.UIOpacity,h=e.tween,m=e.Component}],execute:function(){var g,d,w,y,S,T,v,_,F,z,L,k,G,O,C,I,P,A,B,D,q,E,V,W,x,H,M,X,R,j,J,N;a._RF.push({},"517a3iCMq5JvZ/vk9/yyMz8","WinFireworksShow",void 0);var U=o.ccclass,Z=o.property;e("WinFireworksShow",(g=U("WinFireworksShow"),d=Z(s),w=Z([s]),y=Z(s),S=Z(s),T=Z(s),v=Z(s),_=Z(u),F=Z(u),g((k=t((L=function(e){function t(){for(var t,i=arguments.length,l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];return t=e.call.apply(e,[this].concat(l))||this,n(t,"launchFrom",k,r(t)),n(t,"smallTargets",G,r(t)),n(t,"bigTarget",O,r(t)),n(t,"rocketTpl",C,r(t)),n(t,"smallBurstTpl",I,r(t)),n(t,"bigBurstTpl",P,r(t)),n(t,"subtitleLabel",A,r(t)),n(t,"subtitleGlow",B,r(t)),n(t,"flyTime",D,r(t)),n(t,"arcHeight",q,r(t)),n(t,"rocketStartSpreadX",E,r(t)),n(t,"smallEmitTime",V,r(t)),n(t,"smallLife",W,r(t)),n(t,"subtitleDelayAfterSmall",x,r(t)),n(t,"subtitleFadeIn",H,r(t)),n(t,"subtitleScaleFrom",M,r(t)),n(t,"subtitleGlowAlpha",X,r(t)),n(t,"subtitleGlowScale",R,r(t)),n(t,"bigAfterSubtitle",j,r(t)),n(t,"bigEmitTime",J,r(t)),n(t,"bigLife",N,r(t)),t._spawned=[],t._running=!1,t}i(t,e);var a=t.prototype;return a.stopAndClear=function(){this.unscheduleAllCallbacks(),this._running=!1,this._clearSpawned()},a._clearSpawned=function(){for(var e,t=l(this._spawned);!(e=t()).done;){var i=e.value;i&&i.isValid&&i.destroy()}this._spawned.length=0},a._playParticles=function(e){for(var t,i=e.getComponentsInChildren(c),n=l(i);!(t=n()).done;){t.value.resetSystem()}},a._stopParticles=function(e){for(var t,i=e.getComponentsInChildren(c),n=l(i);!(t=n()).done;){t.value.stopSystem()}},a._spawnFromTpl=function(e,t,i,n){var r=b(e);return r.name=n,r.setParent(t),r.active=!0,r.setPosition(i),this._spawned.push(r),r},a._getStartPos=function(){return this.launchFrom?this.launchFrom.position.clone():new p(0,-420,0)},a.play=function(e,t){var i=this;this._running&&this.stopAndClear(),this._running=!0;var n=this.node;if(!this.rocketTpl||!this.smallBurstTpl||!this.bigBurstTpl)return console.error("[WinFireworksShow] 请在 Inspector 里把 rocketTpl / smallBurstTpl / bigBurstTpl 拖上。"),void(this._running=!1);if(this.smallTargets.length<4)return console.error("[WinFireworksShow] smallTargets 需要至少 4 个：T1~T4。"),void(this._running=!1);if(this.subtitleLabel){this.subtitleLabel.string=e;var r=this.subtitleLabel.node.getComponent(f);r||(r=this.subtitleLabel.node.addComponent(f)),r.opacity=0,this.subtitleLabel.node.setScale(new p(this.subtitleScaleFrom,this.subtitleScaleFrom,1))}if(this.subtitleGlow){this.subtitleGlow.string=e;var l=this.subtitleGlow.node.getComponent(f);l||(l=this.subtitleGlow.node.addComponent(f)),l.opacity=0,this.subtitleGlow.node.setScale(new p(this.subtitleScaleFrom*this.subtitleGlowScale,this.subtitleScaleFrom*this.subtitleGlowScale,1))}for(var a=this._getStartPos(),o=[],s=[],u=0;u<4;u++){var c=this.smallTargets[u],b=a.clone().add(new p((u-1.5)*this.rocketStartSpreadX,0,0)),m=c.position.clone();s.push(m);var g=this._spawnFromTpl(this.rocketTpl,n,b,"rocket_"+u);o.push(g),this._playParticles(g);var d=new p(.5*(b.x+m.x),Math.max(b.y,m.y)+this.arcHeight,0),w=.55*this.flyTime,y=this.flyTime-w;h(g).to(w,{position:d},{easing:"quadOut"}).to(y,{position:m},{easing:"quadIn"}).start()}var S=this.flyTime;this.scheduleOnce((function(){for(var e=function(){var e=r[t];e&&e.isValid&&(i._stopParticles(e),i.scheduleOnce((function(){e.isValid&&e.destroy()}),.25))},t=0,r=o;t<r.length;t++)e();for(var l=function(){var e=i._spawnFromTpl(i.smallBurstTpl,n,s[a],"small_burst_"+a);i._playParticles(e),i.scheduleOnce((function(){return i._stopParticles(e)}),i.smallEmitTime),i.scheduleOnce((function(){e.isValid&&e.destroy()}),i.smallLife)},a=0;a<4;a++)l()}),S);var T=S+this.subtitleDelayAfterSmall;this.scheduleOnce((function(){if(null==t||null==t.onSubtitle||t.onSubtitle(),i.subtitleGlow){var e=i.subtitleGlow.node,n=e.getComponent(f);h(n).to(.85*i.subtitleFadeIn,{opacity:i.subtitleGlowAlpha},{easing:"quadOut"}).start(),h(e).to(i.subtitleFadeIn,{scale:new p(i.subtitleGlowScale,i.subtitleGlowScale,1)},{easing:"quadOut"}).start()}if(i.subtitleLabel){var r=i.subtitleLabel.node,l=r.getComponent(f);h(l).to(i.subtitleFadeIn,{opacity:255},{easing:"quadOut"}).start(),h(r).to(i.subtitleFadeIn,{scale:new p(1,1,1)},{easing:"quadOut"}).start()}}),T);var v=T+this.subtitleFadeIn+this.bigAfterSubtitle;this.scheduleOnce((function(){var e=i.bigTarget?i.bigTarget.position.clone():new p(0,220,0),t=i._spawnFromTpl(i.bigBurstTpl,n,e,"big_burst");t.setSiblingIndex(0),i._playParticles(t),i.scheduleOnce((function(){return i._stopParticles(t)}),i.bigEmitTime),i.scheduleOnce((function(){t.isValid&&t.destroy()}),i.bigLife)}),v);var _=v+this.bigLife+.25;this.scheduleOnce((function(){i._running=!1,null==t||null==t.onDone||t.onDone(),i._clearSpawned()}),_)},t}(m)).prototype,"launchFrom",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(L.prototype,"smallTargets",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=t(L.prototype,"bigTarget",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=t(L.prototype,"rocketTpl",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(L.prototype,"smallBurstTpl",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(L.prototype,"bigBurstTpl",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(L.prototype,"subtitleLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(L.prototype,"subtitleGlow",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(L.prototype,"flyTime",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.75}}),q=t(L.prototype,"arcHeight",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 260}}),E=t(L.prototype,"rocketStartSpreadX",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 22}}),V=t(L.prototype,"smallEmitTime",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.22}}),W=t(L.prototype,"smallLife",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.35}}),x=t(L.prototype,"subtitleDelayAfterSmall",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),H=t(L.prototype,"subtitleFadeIn",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.7}}),M=t(L.prototype,"subtitleScaleFrom",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.94}}),X=t(L.prototype,"subtitleGlowAlpha",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 170}}),R=t(L.prototype,"subtitleGlowScale",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.08}}),j=t(L.prototype,"bigAfterSubtitle",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.18}}),J=t(L.prototype,"bigEmitTime",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.25}}),N=t(L.prototype,"bigLife",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.3}}),z=L))||z));a._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});